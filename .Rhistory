plot(p)
# ggplot2::ggsave(paste(figurespath, 'Expression_Neutrophil_1subject_correVioplot.pdf', sep='/'))
#svg(paste(figurespath,'SuppFigs/Epivar_Monoexp_abchas.svg', sep='/'))
#png(paste(figurespath,'SuppFigs/Epivar_Monoexp_abchas.png', sep='/'))
plot(colMeans(mononetbbexpfeat), mononetbbexpchas, xlab="exp ab",
ylab='chas PP', axes=FALSE,   pch=20, main='Monocytes', col='red')
axis(1)
axis(2)
#dev.off()
#svg(paste(figurespath,'SuppFigs/Epivar_Neuexp_abchas.svg', sep='/'))
#png(paste(figurespath,'SuppFigs/Epivar_Neuexp_abchas.png', sep='/'))
plot(colMeans(neunetbbexpfeat), neunetbbexpchas, xlab="exp ab",
ylab='chas PP',  pch=20, col='blue', main='Neutrophils')
axis(1)
axis(2)
#dev.off()
#svg(paste(figurespath,'SuppFigs/Epivar_Tcellexp_abchas.svg', sep='/'))
#png(paste(figurespath,'SuppFigs/Epivar_Tcellexp_abchas.png', sep='/'))
plot(colMeans(tnetbbexpfeat), tnetbbexpchas, xlab="exp ab",
ylab='chas PP',   pch=20, col='darkgreen', main='Tcells')
axis(1)
axis(2)
#dev.off()
View(daf)
View(neunetexpbbcorr)
View(neunetbbexpfeat)
View(neunetbbexp)
View(neunetbbexpfeat)
###Neutrophils
rneuexp <- chaser::randomize(neunetbbexp, nrandom=nrand, preserve.nodes = NULL,dist.match = T)
rneuexp_chas <-lapply(rneuexp, chas)
rneuexp_feat=lapply(rneuexp, export)
mycols=rainbow(ncol(neunetbbexpfeat))
#svg(paste(figurespath,'Epivar_Neuexp_RandDist_abchas.svg', sep='/'))
plot(colMeans(rneuexp_feat[[1]]),rneuexp_chas[[1]], pch='.', ylim=c(0.02,0.13), xlim=c(2.9,3),col=mycols, xlab='Mean expression Neutrophils', ylab='ChAs on PP network')
for (i in 2:nrand){
points(colMeans(rneuexp_feat[[i]]),rneuexp_chas[[i]], pch='.',col=mycols)
}
points(colMeans(neunetbbexpfeat), neunetbbexpchas,  pch=20, col=mycols)
#dev.off()
##Monocytes
rmonoexp <- chaser::randomize(mononetbbexp, nrandom=nrand, preserve.nodes = NULL,dist.match = T)
rmonoexp_chas <-lapply(rmonoexp, chas)
rmonoexp_feat=lapply(rmonoexp, export)
mycols=rainbow(ncol(mononetbbexpfeat))
#svg(paste(figurespath,'SuppFigs/Epivar_exp_MonoRandDist_abchas.svg', sep='/'))
#png(paste(figurespath,'SuppFigs/Epivar_exp_MonoRandDist_abchas.png', sep='/'))
plot(colMeans(rmonoexp_feat[[1]]),rmonoexp_chas[[1]], pch='.', ylim=c(0.02,0.13),xlim=c(3.,3.2), col=mycols, xlab='Mean expression Monocytes', ylab='ChAs on PP network')
for (i in 2:nrand){
points(colMeans(rmonoexp_feat[[i]]),rmonoexp_chas[[i]], pch='.',col=mycols)
}
points(colMeans(mononetbbexpfeat), mononetbbexpchas,  pch=20, col=mycols)
#dev.off()
library(FactoMineR)
library(factoextra)
library(viper)
library(dplyr)
library(ggsignif)
load("~/DATA/Patients_data2.RData")
Do_cool_scatterplot <- function(Feature, title){
Feature <- dplyr::filter(Feature, Eigen_centrality > 0.0005 & Page_rank != 0 & ((P.Value < 0.05 & abs(logFC) > 1.5) | pval < 0.1))
DEG <- ifelse(Feature$logFC < 0, "DOWN", "UP")
ggplot(Feature, aes(x = log(Page_rank), y = log(Eigen_centrality), label = Gene, colour = DEG))+
geom_text(check_overlap = T, size = 2, nudge_x = 0.05, hjust = 0, outlier.size = 0)+
geom_point(size = 0.5)+
labs(title = paste0("Network-based node prioritization ", title))+
xlab("Page Rank (log)")+
ylab("Eigen Centrality (log)")+
scale_colour_manual(values=c("#0000FF", "#FF0000"))
}
Do_cool_scatterplot_Ver <- function(Feature, title){
Feature <- dplyr::filter(Feature, Eigen_centrality > 0.0005 & Page_rank != 0 & (P.Value < 0.05 | pval < 0.1))
DEG <- ifelse(Feature$logFC < 0, "DOWN", "UP")
ggplot(Feature, aes(x = log(Page_rank), y = log(Eigen_centrality), label = Gene, colour = DEG))+
geom_text(check_overlap = T, size = 2, nudge_x = 0.05, hjust = 0, outlier.size = 0)+
geom_point(size = 0.5)+
labs(title = paste0("Network-based node prioritization ", title))+
xlab("Page Rank (log)")+
ylab("Eigen Centrality (log)")+
scale_colour_manual(values=c("#0000FF", "#FF0000"))
}
RNAseq_diff_exp <- readRDS("~/GitHub/Koichi_gene_expression_analyses_git/Koichi_gene_expression_analyses/Results/Tables/RNAseq_diff_gene_expression_analysis.rds")
View(RNAseq_diff_exp)
View(RNAseq_diff_exp[["R_OR_NR_B"]][["NR.B-R.B"]])
library(ggplot2)
Diff_facs_analysis <- read.csv("Data/Diff_AGI.csv")
Rhod2_facs_analysis <- read.csv("Data/Rhod2_AGI.csv")
PpIX_facs_analysis <- read.csv("Data/PpIX_AGI_ALA_Basal.csv")
Scenith_analysis <- read.csv("Data/Scenith.csv")
Diff_facs_analysis_15_03 <- read.csv("Data/Diff_AGI_15_03.csv")
Diff_facs_analysis_15_03 <- read.csv("Data/Diff_AGI_15_03.csv", sep = "\t")
Diff_facs_analysis_04_05 <- read.csv("Data/Diff_AGI_04_05.csv", sep = "\t")
View(Diff_facs_analysis_15_03)
p <- ggplot2::ggplot(Diff_facs_analysis_15_03, aes(x = Cell.line, y = CD15...APC, color = factor(Treatment, levels = c("DMSO", "AGI"))))
colnames(Diff_facs_analysis_15_03) <- c("Sample", "Cell.line", "Treatment", "GFP", "CD15_APC", "CD38_PC7", "Rhod2")
p <- ggplot2::ggplot(Diff_facs_analysis_15_03, aes(x = Cell.line, y = CD15_APC, color = factor(Treatment, levels = c("DMSO", "AGI"))))
p
p <- p + ggplot2::geom_boxplot()
p
p <- ggplot2::ggplot(Diff_facs_analysis_15_03, aes(x = Cell.line, y = CD15_APC, color = factor(Treatment, levels = c("DMSO", "AGI"))))
p <- p + ggplot2::geom_bar()
p
p <- ggplot2::ggplot(Diff_facs_analysis_15_03, aes(x = Cell.line, y = CD15_APC, color = factor(Treatment, levels = c("DMSO", "AGI"))))
p <- p + ggplot2::geom_jitter()
p
p <- ggplot2::ggplot(Diff_facs_analysis_15_03, aes(x = Cell.line, y = CD15_APC, color = factor(Treatment, levels = c("DMSO", "AGI"))))
p <- p + ggplot2::geom_jitter()
p <- p + ggplot2::labs(color = "Treatment", title = "CD15", x = "Cell lines")+
p
p <- ggplot2::ggplot(Diff_facs_analysis_15_03, aes(x = Cell.line, y = CD15_APC, color = factor(Treatment, levels = c("DMSO", "AGI"))))
p <- p + ggplot2::geom_jitter()
p <- p + labs(color = "Treatment", title = "CD15", x = "Cell lines")+
p
p <- ggplot2::ggplot(Diff_facs_analysis_15_03, aes(x = Cell.line, y = CD15_APC, color = factor(Treatment, levels = c("DMSO", "AGI")))) +
ggplot2::geom_jitter() +
labs(color = "Treatment", title = "CD15", x = "Cell lines")+
p
p <- ggplot2::ggplot(Diff_facs_analysis_15_03, aes(x = Cell.line, y = CD15_APC, color = factor(Treatment, levels = c("DMSO", "AGI")))) +
ggplot::geom_jitter() +
ggplot::labs(color = "Treatment", title = "CD15", x = "Cell lines")+
p
library(ggplot2)
p <- ggplot(Diff_facs_analysis_15_03, aes(x = Cell.line, y = CD15_APC, color = factor(Treatment, levels = c("DMSO", "AGI")))) +
geom_jitter() +
labs(color = "Treatment", title = "CD15", x = "Cell lines")+
p
p <- ggplot(Diff_facs_analysis_15_03, aes(x = Cell.line, y = CD15_APC, color = factor(Treatment, levels = c("DMSO", "AGI")))) +
geom_jitter() +
labs(color = "Treatment", title = "CD15", x = "Cell lines")
p
library(ggplot2)
library(dplyr)
Diff_facs_analysis <- read.csv("Data/Replicat 1/Diff_AGI.csv")
Rhod2_facs_analysis <- read.csv("Data/Replicat 1/Rhod2_AGI.csv")
PpIX_facs_analysis <- read.csv("Data/Replicat 1/PpIX_AGI_ALA_Basal.csv")
Scenith_analysis <- read.csv("Data/Replicat 1/Scenith.csv")
# -----------------------
Replicat2 <- read.csv("Data/Replicat 2/2021 12 14 - Rhod2 - M14R132, 56-11 AGI J+7.csv", nrows = 10, check.names = F, row.names = 1)[,-6]
Rhod2_df <- data.frame("Rhod2" = Replicat2$`Median Rhod2`[c(1:4)],
"Cell.line" = c(rep("56-11",2), rep("M14",2)),
"Treatment" = rep(c("AGI", "DMSO"), 2)) %>%
t() %>%
data.frame() %>%
rev() %>%
t() %>%
data.frame()
CD38_df <- data.frame("CD38" = Replicat2[c(1:4),"Median CD38"],
"Cell.line" = c(rep("56-11", 2), rep("M14", 2)),
"Treatment" = rep(c("AGI", "DMSO"), 2))
CD15_df <- data.frame("CD15" = Replicat2[c(1:4),"Median CD15"],
"Cell.line" = c(rep("56-11", 2), rep("M14", 2)),
"Treatment" = rep(c("AGI", "DMSO"), 2)
)
Scenith_replicat_2 <- data.frame("Cell.line" = c(rep("M14", 2), rep("56-11",2)),
"Mitochondrial_dependancy" = c(62.9, 16.0, 46.7, 40.8),
"Mitochondrial_signal" = c(199824.95, 251765.25, 557897, 450958.25),
"Treatment" = rep(c("DMSO", "AGI"), 2)
)
ggplot(data=Rhod2_facs_analysis, aes(x = Cell.line, y = Rhod2, color = factor(Treatment, levels = c("DMSO", "AGI")))) +
scale_color_manual(values=c("#0000FF", "#FF0000"), limits=c("DMSO", "AGI")) +
geom_bar(stat = "identity", fill = "white", position = position_dodge()) +
labs(color = "Treatment", title = "Calcium indicator", x = "Cell lines")+
theme_minimal()
ggplot(data=Rhod2_df, aes(x = Cell.line, y = as.numeric(Rhod2), color = factor(Treatment, levels = c("DMSO", "AGI")))) +
scale_color_manual(values=c("#0000FF", "#FF0000"), limits=c("DMSO", "AGI")) +
geom_bar(stat = "identity", fill = "white", position = position_dodge()) +
labs(color = "Treatment", title = "Calcium indicator", x = "Cell lines")+
theme_minimal()
Rhod2_rep3 <- data.frame("Rhod2" = c(4084,3896, 1737, 2140),
"Cell.line" = c("56-11", "56-11", "Molm14", "Molm14"),
"Treatment" = c("DMSO", "AGI", "DMSO", "AGI"))
ggplot(data=Rhod2_rep3, aes(x=Cell.line, y=Rhod2, color=factor(Treatment, levels = c("DMSO", "AGI"))))+
scale_color_manual(values=c("#0000FF", "#FF0000"), limits=c("DMSO", "AGI")) +
geom_bar(stat = "identity", fill = "white", position = position_dodge()) +
labs(color = "Treatment", title = "Calcium indicator", x = "Cell lines")+
theme_minimal()
ggplot(data=PpIX_facs_analysis, aes(x = Cell.line, y = MFI_PpIX, color = factor(Treatment, levels = c("DMSO", "AGI")))) +
scale_color_manual(values=c("#0000FF", "#FF0000"), limits=c("DMSO", "AGI")) +
geom_bar(stat = "identity", fill = "white", position = position_dodge()) +
labs(color = "Treatment", title = "PpIX indicator", x = "Cell lines")+
theme_minimal()
ggplot(data=PpIX_facs_analysis, aes(x = Cell.line, y = ALA.basal, color = factor(Treatment, levels = c("DMSO", "AGI")))) +
scale_color_manual(values=c("#0000FF", "#FF0000"), limits=c("DMSO", "AGI")) +
geom_bar(stat = "identity", fill = "white", position = position_dodge()) +
labs(color = "Treatment", title = "PpIX ALA/basal", x = "Cell lines")+
theme_minimal()
ggplot(data=Scenith_analysis, aes(x=factor(Treatment, levels = c("DMSO", "AGI")), y=Gly_dependency, color=factor(Treatment, levels = c("DMSO", "AGI"))))+
scale_color_manual(values=c("#0000FF", "#FF0000"), limits=c("DMSO", "AGI")) +
geom_bar(stat = "identity", fill = "white", position = position_dodge()) +
labs(color = "Treatment", title = "Glycolyse dependency", x = "Treatment")+
theme_minimal()
ggplot(data=Scenith_analysis, aes(x=factor(Treatment, levels = c("DMSO", "AGI")), y=Mito_dependency, color=factor(Treatment, levels = c("DMSO", "AGI"))))+
scale_color_manual(values=c("#0000FF", "#FF0000"), limits=c("DMSO", "AGI")) +
geom_bar(stat = "identity", fill = "white", position = position_dodge()) +
labs(color = "Treatment", title = "Mitochondria dependency", x = "Treatment")+
theme_minimal()
ggplot(data=Scenith_replicat_2, aes(x=Cell.line, y=Mitochondrial_dependancy, color=factor(Treatment, levels = c("DMSO", "AGI"))))+
scale_color_manual(values=c("#0000FF", "#FF0000"), limits=c("DMSO", "AGI")) +
geom_bar(stat = "identity", fill = "white", position = position_dodge()) +
labs(color = "Treatment", title = "Mitochondria dependency", x = "Treatment")+
theme_minimal()
ggplot(data=Diff_facs_analysis[c(1:4),], aes(x=Cell.line, y=CD11b_PE_A, color=factor(Treatment, levels = c("DMSO", "AGI"))))+
scale_color_manual(values=c("#0000FF", "#FF0000"), limits=c("DMSO", "AGI")) +
geom_bar(stat = "identity", fill = "white", position = position_dodge()) +
labs(color = "Treatment", title = "CD11b", x = "Cell lines")+
theme_minimal()
ggplot(data=Diff_facs_analysis[c(1:4),], aes(x=Cell.line, y=CD14.APC__A700_A, color=factor(Treatment, levels = c("DMSO", "AGI"))))+
scale_color_manual(values=c("#0000FF", "#FF0000"), limits=c("DMSO", "AGI")) +
geom_bar(stat = "identity", fill = "white", position = position_dodge()) +
labs(color = "Treatment", title = "CD14", x = "Cell lines")+
theme_minimal()
ggplot(data=Diff_facs_analysis[c(1:4),], aes(x=Cell.line, y=CD15_APC_A, color=factor(Treatment, levels = c("DMSO", "AGI"))))+
scale_color_manual(values=c("#0000FF", "#FF0000"), limits=c("DMSO", "AGI")) +
geom_bar(stat = "identity", fill = "white", position = position_dodge()) +
labs(color = "Treatment", title = "CD15", x = "Cell lines")+
theme_minimal()
ggplot(data=CD15_df, aes(x=Cell.line, y=as.numeric(CD15), color=factor(Treatment, levels = c("DMSO", "AGI"))))+
scale_color_manual(values=c("#0000FF", "#FF0000"), limits=c("DMSO", "AGI")) +
geom_bar(stat = "identity", fill = "white", position = position_dodge()) +
labs(color = "Treatment", title = "CD15", x = "Cell lines")+
theme_minimal()
CD15_rep3 <- data.frame("CD15" = c(4986,3977,1504,1558),
"Cell.line" = c("56-11", "56-11", "Molm14", "Molm14"),
"Treatment" = c("DMSO", "AGI", "DMSO", "AGI"))
ggplot(data=CD15_rep3, aes(x=Cell.line, y=as.numeric(CD15), color=factor(Treatment, levels = c("DMSO", "AGI"))))+
scale_color_manual(values=c("#0000FF", "#FF0000"), limits=c("DMSO", "AGI")) +
geom_bar(stat = "identity", fill = "white", position = position_dodge()) +
labs(color = "Treatment", title = "CD15", x = "Cell lines")+
theme_minimal()
CD38_df <- data.frame("CD38" = Replicat2[c(1:4),"Median CD38"],
"Cell.line" = c(rep("56-11", 2), rep("M14", 2)),
"Treatment" = rep(c("AGI", "DMSO"), 2)
)
ggplot(data=CD38_df[c(1:4),], aes(x=Cell.line, y=as.numeric(CD38), color=factor(Treatment, levels = c("DMSO", "AGI"))))+
scale_color_manual(values=c("#0000FF", "#FF0000"), limits=c("DMSO", "AGI")) +
geom_bar(stat = "identity", fill = "white", position = position_dodge()) +
labs(color = "Treatment", title = "CD38", x = "Cell lines")+
theme_minimal()
CD38_rep2 <- data.frame("CD38" = c(887, 853, 6233,7747),
"Cell.line" = c("56-11", "56-11", "Molm14", "Molm14"),
"Treatment" = c("DMSO", "AGI", "DMSO", "AGI"))
ggplot(data=CD38_rep2, aes(x=Cell.line, y=as.numeric(CD38), color=factor(Treatment, levels = c("DMSO", "AGI"))))+
scale_color_manual(values=c("#0000FF", "#FF0000"), limits=c("DMSO", "AGI")) +
geom_bar(stat = "identity", fill = "white", position = position_dodge()) +
labs(color = "Treatment", title = "CD38", x = "Cell lines")+
theme_minimal()
library(ggplot2)
library(dplyr)
Diff_facs_analysis_replicat_1 <- read.csv("Data/Replicat 1/Diff_AGI.csv")
Rhod2_facs_analysis_replicat_1 <- read.csv("Data/Replicat 1/Rhod2_AGI.csv")
PpIX_facs_analysis_replicat_1 <- read.csv("Data/Replicat 1/PpIX_AGI_ALA_Basal.csv")
Scenith_analysis_replicat_1 <- read.csv("Data/Replicat 1/Scenith.csv")
Replicat2 <- read.csv("Data/Replicat 2/2021 12 14 - Rhod2 - M14R132, 56-11 AGI J+7.csv", nrows = 10, check.names = F, row.names = 1)[,-6]
Rhod2_df <- data.frame("Rhod2" = Replicat2$`Median Rhod2`[c(1:4)],
"Cell.line" = c(rep("56-11",2), rep("M14",2)),
"Treatment" = rep(c("AGI", "DMSO"), 2)) %>%
t() %>%
data.frame() %>%
rev() %>%
t() %>%
data.frame()
CD38_df <- data.frame("CD38" = Replicat2[c(1:4),"Median CD38"],
"Cell.line" = c(rep("56-11", 2), rep("M14", 2)),
"Treatment" = rep(c("AGI", "DMSO"), 2))
CD15_df <- data.frame("CD15" = Replicat2[c(1:4),"Median CD15"],
"Cell.line" = c(rep("56-11", 2), rep("M14", 2)),
"Treatment" = rep(c("AGI", "DMSO"), 2)
)
Scenith_replicat_2 <- data.frame("Cell.line" = c(rep("M14", 2), rep("56-11",2)),
"Mitochondrial_dependancy" = c(62.9, 16.0, 46.7, 40.8),
"Mitochondrial_signal" = c(199824.95, 251765.25, 557897, 450958.25),
"Treatment" = rep(c("DMSO", "AGI"), 2)
)
Rhod2_total_df <- data.frame(Rhod2 = as.numeric(c(Rhod2_facs_analysis_replicat_1$Rhod2, as.numeric(Replicat2$`Median Rhod2`[c(1:4)]), 4084,3896, 1737, 2140)),
Cell_line = c(rep("Molm14" ,2), rep("HL60", 4), rep("Molm14", 2), rep("HL60", 2), rep("Molm14", 2)),
Treatment = c(rep(c("Control", "IDHi"), 2), rep(c("IDHi", "Control"), 2), rep(c("Control", "IDHi"), 2))
)
Scenith_total_df <- data.frame(Mito_dep = c(Scenith_analysis_replicat_1$Mito_dependency, Scenith_replicat_2$Mitochondrial_dependancy),
Cell_line = c(rep("Molm14", 4), rep("HL60", 2)),
Treatment = rep(c("Control", "IDHi"))
)
Diff_facs_analysis_replicat_1 <- Diff_facs_analysis_replicat_1[c(1:4),]
Diff_facs_analysis_replicat_1$Cell.line <- c(rep("Molm14", 2), rep("HL60", 2))
Diff_facs_analysis_replicat_1$Treatment <- rep(c("Control", "IDHi"),2)
cd15 <- data.frame(cd15 = as.numeric(c(Diff_facs_analysis_replicat_1$CD15_APC_A, CD15_df$CD15, 4986,3977,1504,1558)),
Cell_line = c(Diff_facs_analysis_replicat_1$Cell.line, rep(c(rep("HL60", 2), rep("Molm14", 2)), 2)),
Treatment = c(Diff_facs_analysis_replicat_1$Treatment, rep(c("IDHi", "Control"), 2), rep(c("Control", "IDHi"), 2))
)
cd38 <- data.frame(cd38 = as.numeric(c(Replicat2[c(1:4),4], 887, 853, 6233,7747)),
Cell_line = rep(c(rep("HL60", 2), rep("Molm14", 2)), 2),
Treatment = c(rep(c("IDHi", "Control"),2), rep(c("Control", "IDHi"),2))
)
ggplot(data=Rhod2_total_df, aes(x = Cell_line, y = Rhod2, color = factor(Treatment, levels = c("Control", "IDHi")))) +
scale_color_manual(values=c("#0000FF", "#FF0000"), limits=c("Control", "IDHi")) +
geom_boxplot(width = 0.3) +
geom_jitter(position = position_jitterdodge()) +
labs(color = "Treatment", title = "Rhod2", x = "Cell lines", y ="")+
theme_minimal()
ggplot(data=Scenith_total_df, aes(x = Cell_line, y = Mito_dep, color = factor(Treatment, levels = c("Control", "IDHi")))) +
scale_color_manual(values=c("#0000FF", "#FF0000"), limits=c("Control", "IDHi")) +
geom_boxplot(width = 0.3) +
geom_jitter(position = position_jitterdodge()) +
labs(color = "Treatment", title = "Mitochondrial dependency", x = "Cell lines", y = "% Dependancy")+
theme_minimal()
ggplot(data=Diff_facs_analysis_replicat_1, aes(x = Cell.line, y = CD11b_PE_A, color = factor(Treatment, levels = c("Control", "IDHi")))) +
scale_color_manual(values=c("#0000FF", "#FF0000"), limits=c("Control", "IDHi")) +
geom_jitter(position = position_jitterdodge()) +
labs(color = "Treatment", title = "CD11b", x = "Cell lines", y = "")+
theme_minimal()
ggplot(data=cd15, aes(x = Cell_line, y = cd15, color = factor(Treatment, levels = c("Control", "IDHi")))) +
scale_color_manual(values=c("#0000FF", "#FF0000"), limits=c("Control", "IDHi")) +
geom_boxplot(width = 0.3) +
geom_jitter(position = position_jitterdodge(dodge.width = 0.5)) +
labs(color = "Treatment", title = "CD15", x = "Cell lines", y = "")+
theme_minimal()
ggplot(data=Diff_facs_analysis_replicat_1, aes(x = Cell.line, y = CD14.APC__A700_A, color = factor(Treatment, levels = c("Control", "IDHi")))) +
scale_color_manual(values=c("#0000FF", "#FF0000"), limits=c("Control", "IDHi")) +
geom_jitter(position = position_jitterdodge()) +
labs(color = "Treatment", title = "CD14", x = "Cell lines", y = "")+
theme_minimal()
ggplot(data=cd38, aes(x = Cell_line, y = cd38, color = factor(Treatment, levels = c("Control", "IDHi")))) +
scale_color_manual(values=c("#0000FF", "#FF0000"), limits=c("Control", "IDHi")) +
geom_boxplot(width = 0.3) +
geom_jitter(position = position_jitterdodge(dodge.width = 0.5)) +
labs(color = "Treatment", title = "CD38", x = "Cell lines", y = "")+
theme_minimal()
View(cd38)
load("~/GitHub/Multiplex_DNAmet_PPI_Chrom_Coexp/05.05.RData")
load("~/GitHub/Multiplex_DNAmet_PPI_Chrom_Coexp/05.05.RData")
load("/home/alexis/DATA/Koichi_analysis.RData")
GSE153348_IDH_RNA_Seq_matrix_submission <- read.delim("~/GitHub/Multiplex_DNAmet_PPI_Chrom_Coexp/DATA/GSE153348_IDH_RNA_Seq_matrix_submission.txt")
View(GSE153348_IDH_RNA_Seq_matrix_submission)
RNAseq <- read.csv("~/GitHub/Multiplex_DNAmet_PPI_Chrom_Coexp/DATA/GSE153348_IDH_RNA_Seq_matrix_submission.txt", sep = "\t", check.names = F)
View(RNAseq)
RNAseq$Gene <- rownames(RNAseq) %>% str_split(., "[|]") %>% lapply(., function(x){
x[1]
}) %>%
unlist(.)
library(dplyr)
RNAseq$Gene <- rownames(RNAseq) %>% str_split(., "[|]") %>% lapply(., function(x){
x[1]
}) %>%
unlist(.)
library(stringr)
RNAseq$Gene <- rownames(RNAseq) %>% str_split(., "[|]") %>% lapply(., function(x){
x[1]
}) %>%
unlist(.)
RNAseq <- RNAseq %>%
split(., .$Gene) %>%
lapply(., function(x){
l <- length(x[1,]) - 1
cnames <- colnames(x)[c(1:l)]
df <- x[,c(1:l)] %>%
as.matrix(.) %>%
colSums2(.) %>%
data.frame(.) %>%
t(.) %>%
data.frame(.)
colnames(df) <- cnames
df
}) %>%
rbindlist(.) %>%
data.frame(.)
library(data.table)
RNAseq <- RNAseq %>%
split(., .$Gene) %>%
lapply(., function(x){
l <- length(x[1,]) - 1
cnames <- colnames(x)[c(1:l)]
df <- x[,c(1:l)] %>%
as.matrix(.) %>%
colSums2(.) %>%
data.frame(.) %>%
t(.) %>%
data.frame(.)
colnames(df) <- cnames
df
}) %>%
rbindlist(.) %>%
data.frame(.)
library(matrixStats)
RNAseq <- RNAseq %>%
split(., .$Gene) %>%
lapply(., function(x){
l <- length(x[1,]) - 1
cnames <- colnames(x)[c(1:l)]
df <- x[,c(1:l)] %>%
as.matrix(.) %>%
colSums2(.) %>%
data.frame(.) %>%
t(.) %>%
data.frame(.)
colnames(df) <- cnames
df
}) %>%
rbindlist(.) %>%
data.frame(.)
View(RNAseq)
RNAseq <- RNAseq %>%
split(., .$Gene) %>%
lapply(., function(x){
l <- length(x[1,]) - 1
cnames <- colnames(x)[c(1:l)]
df <- x[,c(1:l)] %>%
as.matrix(.) %>%
colSums2(.) %>%
data.frame(.) %>%
t(.) %>%
data.frame(.)
colnames(df) <- cnames
df
}) %>%
rbindlist(.) %>%
data.frame(., check.names = F)
RNAseq <- read.csv("~/GitHub/Multiplex_DNAmet_PPI_Chrom_Coexp/DATA/GSE153348_IDH_RNA_Seq_matrix_submission.txt", sep = "\t", check.names = F)
RNAseq$Gene <- rownames(RNAseq) %>% str_split(., "[|]") %>% lapply(., function(x){
x[1]
}) %>%
unlist(.)
RNAseq <- RNAseq %>%
split(., .$Gene) %>%
lapply(., function(x){
l <- length(x[1,]) - 1
cnames <- colnames(x)[c(1:l)]
df <- x[,c(1:l)] %>%
as.matrix(.) %>%
colSums2(.) %>%
data.frame(.) %>%
t(.) %>%
data.frame(.)
colnames(df) <- cnames
df
}) %>%
rbindlist(.) %>%
data.frame(., check.names = F)
View(RNAseq)
View(RNAseq)
RNAseq <- read.csv("~/GitHub/Multiplex_DNAmet_PPI_Chrom_Coexp/DATA/GSE153348_IDH_RNA_Seq_matrix_submission.txt", sep = "\t", check.names = F)
gene_rownames <- rownames(RNAseq) %>% str_split(., "[|]") %>% lapply(., function(x){
x[1]
}) %>%
unlist(.) %>%
unique(.)
RNAseq$Gene <- rownames(RNAseq) %>% str_split(., "[|]") %>% lapply(., function(x){
x[1]
}) %>%
unlist(.)
RNAseq <- RNAseq %>%
split(., .$Gene) %>%
lapply(., function(x){
l <- length(x[1,]) - 1
cnames <- colnames(x)[c(1:l)]
df <- x[,c(1:l)] %>%
as.matrix(.) %>%
colSums2(.) %>%
data.frame(.) %>%
t(.) %>%
data.frame(.)
colnames(df) <- cnames
df
}) %>%
rbindlist(.) %>%
data.frame(., check.names = F)
rownames(RNAseq) <- gene_rownames
View(RNAseq)
View(RNAseq)
RNAseq_CPM <- convertCounts(RNAseq,
unit = "CPM",
log = FALSE,
normalize = "none")
install.packages("DGEobj.utils")
library(DGEobj.utils)
RNAseq_CPM <- convertCounts(RNAseq,
unit = "CPM",
log = FALSE,
normalize = "none")
RNAseq_CPM <- convertCounts(as.matrix(RNAseq),
unit = "CPM",
log = FALSE,
normalize = "none")
View(RNAseq_CPM)
write.csv(RNAseq_CPM, "/mnt/SERVER-CRCT-STORAGE/CRCT18/UTILISATEURS/Alexis/DATA/RNAseq_mIDHi_cohort_CPM.csv")
load("~/GitHub/Multiplex_DNAmet_PPI_Chrom_Coexp/05.05.RData")
load("~/27.04.RData")
library(RCy3)
load("~/09.05.2022.RData")
View(Transcriptomes)
suppressPackageStartupMessages({
library(hugene20sttranscriptcluster.db)
library(oligo)
library(data.table)
})
suppressPackageStartupMessages({
library(dplyr)
library(chaser)
library(stringr)
library(biomaRt)
library(gridExtra)
library(grid)
library(ggplot2)
})
setwd("~/GitHub/Multiplex_DNAmet_PPI_Chrom_Coexp/")
source("~/Core_scripts/core_functions.R")
source("~/GitHub/Multiplex_DNAmet_PPI_Chrom_Coexp/Make_koichi_factor.R")
RNAseq_1 <- read.csv("~/GitHub/Koichi_gene_expression_analyses_git/Koichi_gene_expression_analyses/DATA/RNAseq_parsed.csv", row.names = 1, header = T, check.names = F)
Factor_R_OR_NR_B
length(Factor_R_OR_NR_B)
colnames(RNAseq_1)[Factor_R_OR_NR_B == "NR.B"]
colnames(RNAseq_1)[Factor_R_OR_NR_B == "R.B"]
colnames(RNAseq_1)[Factor_R_OR_NR_B == "R.REL"]
colnames(RNAseq_1)[Factor_R_OR_NR_B == "OR.REL"]
